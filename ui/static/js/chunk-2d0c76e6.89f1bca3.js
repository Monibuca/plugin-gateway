(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c76e6"],{"511e":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"搜索名称关键词"},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}})],1),t._v(" "),n("el-form-item",{staticStyle:{float:"right"}},[n("el-button",{attrs:{type:"primary"},on:{click:t.onAddRtsp}},[t._v("添加拉流转发")])],1)],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.pageList,border:"",fit:""}},[n("el-table-column",{attrs:{label:"StreamPath"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.URL)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"开始时间",width:"100px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("formatPassTimeFilter")(e.row.Stream&&e.row.Stream.StartTime))+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"总接收",width:"100px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("unitSpeedFormatFilter")(e.row.InBytes))+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"总发送",width:"100px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("unitSpeedFormatFilter")(e.row.OutBytes))+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"音频"}},[n("el-table-column",{attrs:{align:"center",label:"格式",width:"210px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.ASdp&&e.row.ASdp.Codec)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"采样率",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.RtpAudio?[t._v("\n            "+t._s(t._f("soundRateFilter")(e.row.RtpAudio.SoundRate))+"\n          ")]:t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"声道",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.RtpAudio?[t._v("\n            "+t._s(e.row.RtpAudio.Channels)+"\n          ")]:t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"码率",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.RtpAudio?[t._v("\n            "+t._s(t._f("unitSpeedFormatFilter")(e.row.RtpAudio.BPS))+"\n          ")]:t._e()]}}])})],1),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"视频"}},[n("el-table-column",{attrs:{align:"center",label:"格式",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.VSdp&&e.row.VSdp.Codec)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"分辨率",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.RtpVideo&&e.row.RtpVideo.SPSInfo?[t._v("\n            "+t._s(e.row.RtpVideo.SPSInfo.Width)+"x"+t._s(e.row.RtpVideo.SPSInfo.Height)+"\n          ")]:t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"GOP",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.RtpVideo&&e.row.RtpVideo.GOP)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",width:"120px",label:"码率"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.RtpVideo&&e.row.RtpVideo.SPSInfo?[n("div",[t._v(t._s(t._f("unitSpeedFormatFilter")(e.row.RtpVideo.BPS)))])]:t._e()]}}])})],1),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return t.onShowHeader(e.row)}}},[t._v("头信息\n        ")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return t.onStop(e.row)}}},[t._v("中止\n        ")])]}}])})],1),t._v(" "),n("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{background:"","hide-on-single-page":"",layout:"prev, pager, next","current-page":t.currentPage,total:t.dataListFilter.length},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}}),t._v(" "),n("el-dialog",{attrs:{title:"添加拉流转发",visible:t.dialogVisible,width:"800px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",[n("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.tempForm,"label-width":"220px"}},[n("el-form-item",{attrs:{prop:"streamPath",label:"StreamPath(m7s流标识）"}},[n("el-input",{attrs:{placeholder:"live/test"},model:{value:t.tempForm.streamPath,callback:function(e){t.$set(t.tempForm,"streamPath",e)},expression:"tempForm.streamPath"}})],1),t._v(" "),n("el-form-item",{attrs:{prop:"target",label:"RTSP源地址或者HLS源地址"}},[n("el-input",{attrs:{placeholder:"输入拉流地址"},model:{value:t.tempForm.target,callback:function(e){t.$set(t.tempForm,"target",e)},expression:"tempForm.target"}})],1)],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",loading:t.dialogSubmitting},on:{click:function(e){return t.handleRelay("dataForm")}}},[t._v("确 定")])],1)]),t._v(" "),n("el-dialog",{attrs:{title:"RTSP SDPRaw",visible:t.dialogVisible2,width:"1000px"},on:{"update:visible":function(e){t.dialogVisible2=e}}},[n("pre",{staticStyle:{"max-height":"900px",overflow:"auto"}},[t._v("     "+t._s(t.tempRtspSDPRaw)+"\n   ")]),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible2=!1}}},[t._v("关 闭")])],1)])],1)},r=[],o=(n("55dd"),n("4ec3")),i=n("5c96"),l={name:"relays",data:function(){return{dataList:[],rtsplist:[],hlslist:[],searchKey:"",currentPage:1,dialogVisible:!1,dialogVisible2:!1,tempRtspSDPRaw:"",tempForm:{streamPath:"",target:""},dialogSubmitting:!1,rules:{streamPath:[{required:!0,trigger:"blur",message:"require streamPath"}],target:[{required:!0,trigger:"blur",message:"require target"}]}}},created:function(){this.init()},computed:{dataListFilter:function(){var t=[],e=this.searchKey.trim();return t=e?this.dataList.filter((function(t){return-1!==t.URL.indexOf(e)})):this.dataList,t},pageList:function(){return this.dataListFilter.slice(10*(this.currentPage-1),10*this.currentPage)}},methods:{init:function(){this.getList()},getList:function(){var t=this,e=Object(o["n"])(),n=Object(o["m"])();this.$on("hook:destroyed",(function(){e.close(),n.close()}));var a=[],r=[];n.onmessage=function(e){e.data&&(r=JSON.parse(e.data)||[],r.sort((function(t,e){return t.URL>e.URL?1:-1})),t.hlslist=r,t.dataList=t.rtsplist.concat(t.hlslist))},e.onmessage=function(e){e.data&&(a=JSON.parse(e.data)||[],a.sort((function(t,e){return t.URL>e.URL?1:-1})),t.rtsplist=a,t.dataList=t.rtsplist.concat(t.rtsplist))},e.onerror=function(t){Object(i["Message"])({message:"EventSource failed",type:"error",duration:5e3})},n.onerror=function(t){Object(i["Message"])({message:"EventSource failed",type:"error",duration:5e3})}},onAddRtsp:function(){this.dialogVisible=!0,this.tempForm.streamPath="",this.tempForm.target=""},onShowHeader:function(t){this.tempRtspSDPRaw=t.SDPRaw,this.dialogVisible2=!0},onStop:function(t){var e=this;this.$confirm("是否中止流转发","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["y"])(t.StreamInfo.StreamPath).then((function(t){1===t.code?e.$message({type:"error",message:t.msg||"网络异常"}):e.$message({type:"success",message:"中止流转发成功!"})}))})).catch((function(){}))},handleRelay:function(t){var e=this;this.$refs[t].validate((function(t){t&&(e.dialogSubmitting=!0,(0==e.tempForm.target.indexOf("rtsp")?o["v"]:o["u"])(e.tempForm).then((function(t){1===t.code?e.$message({type:"error",message:t.msg||"网络异常"}):e.$message({type:"success",message:"已启动拉流!"}),e.dialogVisible=!1})).finally((function(){e.dialogSubmitting=!1})))}))}},destroyed:function(){}},s=l,u=n("2877"),c=Object(u["a"])(s,a,r,!1,null,"5ba08848",null);e["default"]=c.exports}}]);